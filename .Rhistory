mtext("Reads aligned",side=4,line=4)
aligned
173138
269461/173138
371281/2321735
sum(aligned[grep("hs_",:SLX-12998.D708_D502.HH772BBXX.s_2")]
sum(aligned[grep("hs_",SLX-12998.D708_D502.HH772BBXX.s_2")]
sum(aligned[grep("hs_","SLX-12998.D708_D502.HH772BBXX.s_2")]
""
sum(aligned[grep("hs_","SLX-12998.D708_D502.HH772BBXX.s_2")]
""
sum(aligned[grep("hs_","SLX-12998.D708_D502.HH772BBXX.s_2")])
aligned[grep("hs_",aligned["SLX-12998.D708_D502.HH772BBXX.s_2"])])
aligned["SLX-12998.D708_D502.HH772BBXX.s_2"]
grep("hs_",aligned["SLX-12998.D708_D502.HH772BBXX.s_2"])
grep("hs_",names(aligned["SLX-12998.D708_D502.HH772BBXX.s_2"])
)
grep("hs_",names(aligned["SLX-12998.D708_D502.HH772BBXX.s_2"]))
grep("hs_",names(aligned["SLX-12998.D708_D502.HH772BBXX.s_2"]))
names(aligned["SLX-12998.D708_D502.HH772BBXX.s_2"])
aligned["SLX-12998.D708_D502.HH772BBXX.s_2"]
names(aligned["SLX-12998.D708_D502.HH772BBXX.s_2"])
names(aligned["SLX-12998.D708_D502.HH772BBXX.s_2"][])
hss<-sapply(aligned,function(x){
sum(x[grep("hs_",names(x))])
})
hss
mms<-sapply(aligned,function(x){
sum(x[grep("mm_",names(x))])
})
mms
2685891/36439889
toplot[,1]<-mms
toplot[,2]<-hss
toplot[,3]<-mms+hss
toplot[,4]<-mms/(mms+hss)
toplot[,5]<-mms/(mms+hss)
toplot<-toplot[grep('SLX-12998.D', sort(rownames(toplot)), value=TRUE),]
toplot
# Sort by total reads aligned
toplot<-toplot[order(-toplot[,3]),]
png("plots/012_SLX-12998_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
dev.off()
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
toplot[,5]<-hms/(mms+hss)
toplot<-toplot[grep('SLX-12998.D', sort(rownames(toplot)), value=TRUE),]
# Sort by total reads aligned
toplot<-toplot[order(-toplot[,3]),]
png("plots/012_SLX-12998_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
dev.off()
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
toplot
toplot[,5]<-hms/(mms+hss)
samples<-names(nrreads)
toplot<-matrix(nrow=length(samples),ncol=5)
colnames(toplot)<-c("MmTot","HsTot","Tot","MmRel","HsRel")
rownames(toplot)<-samples
mms<-sapply(aligned,function(x){
sum(x[grep("mm_",names(x))])
})
hss<-sapply(aligned,function(x){
sum(x[grep("hs_",names(x))])
})
toplot[,1]<-mms
toplot[,2]<-hss
toplot[,3]<-mms+hss
toplot[,4]<-mms/(mms+hss)
toplot[,5]<-hss/(mms+hss)
toplot<-toplot[grep('SLX-12998.D', sort(rownames(toplot)), value=TRUE),]
## Barplot of relative alignments
# Convert sample names to informative ones
rownames(toplot)<-c(
"4b-",#"SLX-12998.D704_D505",
"2b-",#"SLX-12998.D704_D506",
"2a+",#"SLX-12998.D704_D507",
"1a+",#"SLX-.D705_D506",
"Input",#"SLX-.D705_D507",
"3b-",#"SLX-.D705_D508",
"3a+",#"SLX-12998.D706_D505",
"4a+",#"SLX-12998.D706_D507",
"1b-"#"SLX-12998.D706_D508"
)
# Sort by total reads aligned
toplot<-toplot[order(-toplot[,3]),]
png("plots/012_SLX-12998_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
dev.off()
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
lines(bpx,raxis,type="b",lwd=3,pch=16, ymin=0)
lines(bpx,raxis,type="b",lwd=3,pch=16, ylim <- c(0, max(yvalues)))
lines(bpx,raxis,type="b",lwd=3,pch=16, ylim=c(0, max(yvalues)))
lines(bpx,raxis,type="b",lwd=3,pch=16, ylim=c(0, max(raxis)))
lines(bpx,raxis,type="b",lwd=3,pch=16, ylim=c(0, max(raxis)))
png("plots/012_SLX-12998_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16, ylim=c(0, max(raxis)))
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
lines(bpx,raxis,type="b",lwd=3,pch=16, ylim=c(0, max(raxis)))
lines(bpx,raxis,type="b",lwd=3,pch=16, ylim=c(-1000, max(raxis)))
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
lines(bpx*500,raxis,type="b",lwd=3,pch=16, ylim=c(-1000, max(raxis)))
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
png("plots/012_SLX-12998_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx*500,raxis,type="b",lwd=3,pch=16, ylim=c(-1000, max(raxis)))
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
dev.off()
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx*500,raxis,type="b",lwd=3,pch=16, ylim=c(-1000, max(raxis)))
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
lines(bpx,raxis,type="b",lwd=3,pch=16, ylim=c(-1000, max(raxis)))
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16,ylim=c(2,3) )
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
?lines
lines(bpx,raxis,type="b",lwd=3,pch=16)
raxis
bpx
pretty()
?pretty
toplot[,3]
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])))
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])+min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
raxis
toplot[,3]
min(toplot[,3]))/(max(toplot[,3])
/(max(toplot[,3])
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])+min(toplot[,3]))
toplot[,3]
raxis
toplot[,3]
min(toplot[,3]))/(max(toplot[,3])
min(toplot[,3]))/(max(toplot[,3]
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]-min(toplot[,3]))/(max(toplot[,3])-min(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])-min(toplot[,3])) + min(toplot[,3])
))
par(las=3)
mtext("Reads aligned",side=4,line=4)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])))
))
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])))
)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
raxis
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(c(0,1),
labels=(pretty(raxis) * (max(toplot[,3])))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
png("plots/012_SLX-12998_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(c(0,1)),
labels=(pretty(raxis) * (max(toplot[,3])))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(c(0,1)),
labels=(pretty(raxis) * (max(toplot[,3])))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
dev.off()
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(1,2,3,4),
labels=(pretty(raxis) * (max(toplot[,3])))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=pretty(raxis),
labels=(pretty(raxis) * (max(toplot[,3])))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
seq(0,1,0.1)
seq(0,1,0.2)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=seq(0,1,0.2),
labels=seq(0,1,0.2) * (max(toplot[,3])))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=seq(0,1,0.2),
labels=seq(0,1,0.2) * (max(toplot[,3]))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("royalblue2","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("royalblue2","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=seq(0,1,0.2),
labels=seq(0,1,0.2) * (max(toplot[,3]))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
png("plots/012_SLX-12998_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("royalblue2","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("royalblue2","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=seq(0,1,0.2),
labels=seq(0,1,0.2) * (max(toplot[,3]))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
dev.off()
png("plots/012_SLX-12998_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("royalblue2","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Mouse","Human"),col=c("royalblue2","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3])/(max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=seq(0,1,0.2),
labels=seq(0,1,0.2) * (max(toplot[,3]))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
dev.off()
setwd("/Volumes/Flypeaks/flypeaks")
filename<-"Rdata/012_SLX-8047_aligned.rda"
if(!file.exists(filename)){
aligned<-list()
for(nr in names(nrreads)){
bn<-paste0(nr,".r_1.fq.gz.bam")
file<-paste0("./SLX-8047_dmhs/",bn)
# SAM tools flags
# -F256 removes the non primary alignments
# -F4 remove the non aligned ones
lines<-system(paste0("samtools view -F 260 ",file," | cut -f3 | sort | uniq -c"),intern=TRUE)
tmp<-strsplit(lines," ")
al<-as.numeric(sapply(tmp,function(x){
return(x[length(x)-1])
}))
names(al)<-sapply(tmp,function(x){
return(x[length(x)])
})
aligned[[nr]]<-al
}
save(aligned,file=filename)
} else {
load(filename)
}
filename<-"Rdata/012_SLX-8047_nrreads.rda"
load(filename)
nrreads<-nrreads[2:10]#Remove lost reads
aligned<-aligned[2:10]
samples<-names(nrreads)
toplot<-matrix(nrow=length(samples),ncol=5)
colnames(toplot)<-c("DmTot","HsTot","Tot","DmRel","HsRel")
rownames(toplot)<-samples
dms<-sapply(aligned,function(x){
sum(x[grep("dm_",names(x))])
})
hss<-sapply(aligned,function(x){
sum(x[grep("hs_",names(x))])
})
toplot[,1]<-dms
toplot[,2]<-hss
toplot[,3]<-dms+hss
toplot[,4]<-dms/(dms+hss)
toplot[,5]<-hss/(dms+hss)
toplot<-toplot[grep('SLX-8047.D', sort(rownames(toplot)), value=TRUE),]
rownames(toplot)<-c(
"4b-",#"SLX-8047.D704_D505",
"2b-",#"SLX-8047.D704_D506",
"2a+",#"SLX-8047.D704_D507",
"1a+",#"SLX-8047.D705_D506",
"Input",#"SLX-8047.D705_D507",
"3b-",#"SLX-8047.D705_D508",
"3a+",#"SLX-8047.D706_D505",
"4a+",#"SLX-8047.D706_D507",
"1b-"#"SLX-8047.D706_D508"
)
toplot<-toplot[order(-toplot[,3]),]
png("plots/012_SLX-8047_relativeAligned.png",w=1000,h=1000,point=30)
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Drosophila","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]/max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=seq(0,1,0.2),
labels=seq(0,1,0.2) * (max(toplot[,3]))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
dev.off()
par(las=2,mar=c(4,4,3,5))
bp<-barplot(t(toplot[,4:5]),beside=TRUE,main="Relative Read Alignment in samples",
ylab="Fraction of total aligned",col=c("darkolivegreen4","tomato"),ylim=c(-0.05,1.05))
grid()
legend("topright",legend=c("Drosophila","Human"),col=c("darkolivegreen4","tomato"),pch=15)
bpx<-apply(bp,2,mean)
raxis<-(toplot[,3]/max(toplot[,3]))
lines(bpx,raxis,type="b",lwd=3,pch=16)
axis(4,at=seq(0,1,0.2),
labels=seq(0,1,0.2) * (max(toplot[,3]))
)
par(las=3)
mtext("Reads aligned",side=4,line=4)
